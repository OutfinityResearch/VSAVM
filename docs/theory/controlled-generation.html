<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Controlled generation with closure gating | VSAVM</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;600&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/site.css">
  </head>
  <body>
    <div class="site">
      <header class="header">
        <div class="brand">VSAVM</div>
        <nav class="nav">
          <a href="../index.html">Home</a>
          <a href="../specs/">Specs</a>
          <a href="../theory/index.html">Theory</a>
          <a href="../wiki/index.html">Wiki</a>
        </nav>
      </header>
      <main class="main content">
        <h1>Controlled generation with closure gating</h1>
<p>This page is a theory note. It expands the topic in short chapters and defines terminology without duplicating the formal specification documents.</p><p>The diagram has a transparent background and is intended to be read together with the caption and the sections below.</p>
<p>Related wiki pages: <a href="../wiki/vm.html">VM</a>, <a href="../wiki/event-stream.html">event stream</a>, <a href="../wiki/vsa.html">VSA</a>, <a href="../wiki/bounded-closure.html">bounded closure</a>, <a href="../wiki/consistency-contract.html">consistency contract</a>.</p>
<p>Related specs: <a href="../specs-viewer.html?doc=specs/DS001-foundations-and-architecture.md">DS001</a>, <a href="../specs-viewer.html?doc=specs/DS004-correctness-bounded-closure.md">DS004</a>.</p>

<h2>Overview</h2>
<p>VSAVM does not treat generation as free-form continuation. Candidates are proposed by learned distributions and schema constraints, but they must be verified against the VM state. This prevents the surface generator from introducing unsupported claims that violate correctness.</p>

<h2>Phrase-level generation architecture</h2>
<p>Next-phrase generation operates at a semantic granularity bridging token-level language modeling and symbolic reasoning:</p>
<ul>
  <li><strong>Phrase boundaries</strong>: Determined by syntactic analysis and semantic coherence. Natural breaking points correspond to noun phrases, verb phrases, prepositional phrases, and complete clauses expressing single propositions.</li>
  <li><strong>Semantic correspondence</strong>: Each phrase represents a meaningful semantic unit directly relatable to facts, rules, or VM operations. This enables tighter integration between language generation and symbolic reasoning.</li>
  <li><strong>Reduced conditioning overhead</strong>: Phrase-level approach requires fewer conditioning operations per response. Comprehensive state updates occur at phrase boundaries, incorporating full logical implications.</li>
</ul>

<h2>VM state conditioning mechanisms</h2>
<p>Phrase generation is conditioned on virtual machine state through multiple channels:</p>
<ul>
  <li><strong>Fact-based conditioning</strong>: Highlights facts relevant to current generation context. Attention weights computed based on semantic similarity, recency, and confidence level.</li>
  <li><strong>Rule-based conditioning</strong>: Incorporates applicable logical rules and inference patterns. Tracks rule application sequences for coherent explanations.</li>
  <li><strong>Process-based conditioning</strong>: Aware of current reasoning goals, progress, and obstacles. Produces appropriate intermediate responses or requests for information.</li>
  <li><strong>Context-based conditioning</strong>: Hierarchical representation of immediate conversational context, broader topical context, and global consistency constraints.</li>
</ul>

<h2>Consistency enforcement during generation</h2>
<p>Multiple consistency mechanisms operate in real-time:</p>
<ul>
  <li><strong>Pre-generation checking</strong>: Evaluates candidate phrases before commitment. Rapid simulation identifies obvious contradictions; more sophisticated checking for survivors.</li>
  <li><strong>Incremental checking</strong>: Monitors cumulative logical implications. Running model of logical state implied by generated content, updated after each phrase. Backtracking when contradictions detected.</li>
  <li><strong>Post-generation validation</strong>: Comprehensive consistency checking on completed responses via bounded closure analysis. Can revise or add qualifications.</li>
</ul>

<h2>Contradiction resolution strategies</h2>
<p>When consistency constraints cannot be satisfied through phrase substitution:</p>
<ul>
  <li><strong>Source-based resolution</strong>: Prioritize more reliable sources, acknowledge contradictions, indicate preferences.</li>
  <li><strong>Temporal resolution</strong>: Qualify temporal scope when contradictions arise from changes over time.</li>
  <li><strong>Uncertainty-based resolution</strong>: Explicitly acknowledge areas of uncertainty rather than forced resolution.</li>
</ul>

<h2>Closure gating</h2>
<p>Before accepting a candidate, the system simulates its effect and runs a local bounded closure to detect contradictions. If contradictions are detected, the candidate is rejected in strict mode. If exploration is incomplete, the system can emit a conditional result rather than an unconditional claim.</p>

<h2>Response quality optimization</h2>
<p>Generation incorporates multiple optimization mechanisms:</p>
<ul>
  <li><strong>Fluency optimization</strong>: Natural language style models guide toward readable, natural-sounding expressions while maintaining accuracy.</li>
  <li><strong>Coherence optimization</strong>: Discourse models track thematic development and logical structure. Address both local (adjacent sentences) and global (entire response) coherence.</li>
  <li><strong>Informativeness optimization</strong>: Balance comprehensive information with clarity and conciseness. Learned models of information importance guide content selection.</li>
  <li><strong>Engagement optimization</strong>: Consider user expertise, conversational goals, social appropriateness. Models of conversational dynamics guide effective responses.</li>
</ul>

<h2>Budget as user-controlled effort</h2>
<p>When a user asks the system to think more, the budget increases. This increases the depth or breadth of closure and therefore changes what is safe to claim. The system should surface that budget explicitly because it defines the strength of the response.</p>
<figure class="diagram">
<svg viewBox="0 0 900 420" role="img" aria-label="Controlled generation diagram">
  <defs>
    <linearGradient id="sky" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="#e8f3ff"/>
      <stop offset="1" stop-color="#d6f5e8"/>
    </linearGradient>
    <linearGradient id="deep" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="#0b6eff"/>
      <stop offset="1" stop-color="#16b879"/>
    </linearGradient>
  </defs>
  <rect x="80" y="60" rx="18" ry="18" width="220" height="70" fill="url(#sky)" stroke="#7fb3e6" stroke-width="2"/>
<text x="190.0" y="99.0" text-anchor="middle" font-size="13" fill="#0b1a2b" font-family="Space Grotesk">Propose phrases</text>
<rect x="320" y="60" rx="18" ry="18" width="220" height="70" fill="url(#sky)" stroke="#7fb3e6" stroke-width="2"/>
<text x="430.0" y="99.0" text-anchor="middle" font-size="13" fill="#0b1a2b" font-family="Space Grotesk">Simulate + check</text>
<rect x="560" y="60" rx="18" ry="18" width="220" height="70" fill="url(#sky)" stroke="#7fb3e6" stroke-width="2"/>
<text x="670.0" y="99.0" text-anchor="middle" font-size="13" fill="#0b1a2b" font-family="Space Grotesk">Accept / reject</text>
<line x1="300" y1="95" x2="320" y2="95" stroke="url(#deep)" stroke-width="4" stroke-linecap="round"/>
<polygon points="310,88 310,102 330,95" fill="#16b879"/>
<line x1="540" y1="95" x2="560" y2="95" stroke="url(#deep)" stroke-width="4" stroke-linecap="round"/>
<polygon points="550,88 550,102 570,95" fill="#16b879"/>

<rect x="180" y="160" rx="18" ry="18" width="540" height="70" fill="url(#sky)" stroke="#7fb3e6" stroke-width="2"/>
<text x="450.0" y="199.0" text-anchor="middle" font-size="13" fill="#0b1a2b" font-family="Space Grotesk">Gate: bounded closure rejects contradictions</text>
<line x1="430" y1="130" x2="450" y2="160" stroke="#0b6eff" stroke-width="4" stroke-linecap="round"/>
<polygon points="440,153 440,167 460,160" fill="#16b879"/>

<rect x="80" y="260" rx="18" ry="18" width="260" height="70" fill="url(#sky)" stroke="#7fb3e6" stroke-width="2"/>
<text x="210.0" y="299.0" text-anchor="middle" font-size="13" fill="#0b1a2b" font-family="Space Grotesk">VM state conditioning</text>
<rect x="360" y="260" rx="18" ry="18" width="260" height="70" fill="url(#sky)" stroke="#7fb3e6" stroke-width="2"/>
<text x="490.0" y="299.0" text-anchor="middle" font-size="13" fill="#0b1a2b" font-family="Space Grotesk">Quality optimization</text>
<rect x="640" y="260" rx="18" ry="18" width="180" height="70" fill="url(#sky)" stroke="#7fb3e6" stroke-width="2"/>
<text x="730.0" y="299.0" text-anchor="middle" font-size="13" fill="#0b1a2b" font-family="Space Grotesk">Resolution</text>
<line x1="450" y1="230" x2="210" y2="260" stroke="#0b6eff" stroke-width="3" stroke-linecap="round"/>
<line x1="450" y1="230" x2="490" y2="260" stroke="#0b6eff" stroke-width="3" stroke-linecap="round"/>
<line x1="450" y1="230" x2="730" y2="260" stroke="#0b6eff" stroke-width="3" stroke-linecap="round"/>

<rect x="80" y="350" width="500" height="70" rx="16" ry="16" fill="none" stroke="#7fb3e6" stroke-width="2"/>
<text x="96" y="372" text-anchor="start" font-size="12" fill="#2f4a63" font-family="Space Grotesk">Legend</text>
<text x="96" y="394" text-anchor="start" font-size="12" fill="#2f4a63" font-family="Space Grotesk">Generation is proposal + verification. Closure is a gate, not an afterthought.</text>
<text x="96" y="412" text-anchor="start" font-size="12" fill="#2f4a63" font-family="Space Grotesk">VM conditioning + quality optimization + resolution strategies ensure coherent output.</text>
</svg>
<figcaption>Generation is treated as proposal followed by verification: candidates must pass closure-based consistency checks before being emitted. VM state conditioning ensures logical coherence.</figcaption>
</figure>
<h2>References</h2>
<p><a href="https://en.wikipedia.org/wiki/Beam_search">Beam search (Wikipedia)</a> <a href="https://en.wikipedia.org/wiki/Transitive_closure">Transitive closure (Wikipedia)</a> <a href="https://en.wikipedia.org/wiki/Verification_and_validation">Verification and validation (Wikipedia)</a> <a href="https://en.wikipedia.org/wiki/Natural_language_generation">Natural language generation (Wikipedia)</a></p>
      </main>
      <footer class="footer">
        VSAVM is an Axiologic Research experiment within the Achilles project. This static documentation is written in clear academic English for engineers.
      </footer>
    </div>
  </body>
</html>
