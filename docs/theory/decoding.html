<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Faithful surface realization | VSAVM</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;600&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/site.css">
  </head>
  <body>
    <div class="site">
      <header class="header">
        <div class="brand">VSAVM</div>
        <nav class="nav">
          <a href="../index.html">Home</a>
          <a href="../specs/">Specs</a>
          <a href="../theory/index.html">Theory</a>
          <a href="../wiki/index.html">Wiki</a>
        </nav>
      </header>
      <main class="main content">
        <h1>Faithful surface realization</h1>
<p>This page is a theory note. It expands the topic in short chapters and defines terminology without duplicating the formal specification documents.</p><p>The diagram has a transparent background and is intended to be read together with the caption and the sections below.</p>
<p>Related wiki pages: <a href="../wiki/vm.html">VM</a>, <a href="../wiki/event-stream.html">event stream</a>, <a href="../wiki/vsa.html">VSA</a>, <a href="../wiki/bounded-closure.html">bounded closure</a>, <a href="../wiki/consistency-contract.html">consistency contract</a>.</p>
<p>Related specs: <a href="../specs-viewer.html?doc=specs/DS004-correctness-bounded-closure.md">DS004</a>, <a href="../specs-viewer.html?doc=specs/DS011-generative-decoding.md">DS011</a>.</p>

<h2>Overview</h2>
<p>Decoding is a common place where systems silently reintroduce hallucinations. VSAVM treats decoding as <strong>surface realization of internal artifacts</strong>: if the VM did not derive a claim (or the budget was insufficient to verify it), the realizer is not allowed to present it as an unconditional fact.</p>

<h2>Implemented today: deterministic rendering pipeline</h2>
<p>The current implementation is intentionally conservative and deterministic. It lives in <code>src/generation/generation-service.mjs</code> and is used when rendering a query result.</p>
<ol>
  <li><strong>Claim selection</strong>: take the closure result’s <code>claims</code> (already produced by VM execution and bounded closure).</li>
  <li><strong>Claim rendering</strong>: convert each claim term into a stable textual form (see <code>ClaimRenderer</code>).</li>
  <li><strong>Uncertainty marking</strong>: if the closure mode is conditional, add lightweight qualifiers (see <code>UncertaintyMarker</code>).</li>
  <li><strong>Mode adaptation</strong>: strict = render as-is; conditional = prefix with “Conditional”; indeterminate = return an explicit indeterminate message (see <code>ModeAdapter</code>).</li>
  <li><strong>Audit hint</strong>: optionally append a short trace note when trace references exist (see <code>TraceExplainer</code>).</li>
</ol>

<h2>Fidelity preservation mechanisms</h2>
<p>Fidelity is preserved by construction, not by a separate “truth checker”:</p>
<ul>
  <li><strong>No new claims</strong>: the renderer only formats claims already present in the closure result.</li>
  <li><strong>Explicit boundary behavior</strong>: conditional and indeterminate modes are surfaced in the output text, not hidden.</li>
  <li><strong>Trace pointers</strong>: when present, traces provide a hook for auditing what was executed.</li>
</ul>

<h2>What is realized</h2>
<p>The VM can produce a result mode, a set of claims (terms), conflicts, assumptions, and trace references. Today’s realizer focuses on <strong>claims-to-text</strong>. Higher-level report formatting can be built on top, but the invariant remains: every asserted line must correspond to a checked internal artifact.</p>

<h2>Continuation is separate from decoding (DS011)</h2>
<p>DS011 adds an optional macro-unit language model that can generate byte continuations under budgets. This is exercised in <code>eval_tinyLLM</code> for fair comparisons against a TensorFlow baseline. Importantly:</p>
<ul>
  <li><strong>Continuation is not the default answer path</strong> for VM query answering.</li>
  <li><strong>Continuation must not be treated as truth</strong>: when VM state is available, proposals are expected to be gated by claim validation and/or closure checks.</li>
</ul>

<h2>Quality assurance and validation</h2>
<p>For surface realization, validation is mostly structural:</p>
<ul>
  <li><strong>Determinism</strong>: strict mode output is deterministic for the same input and VM state.</li>
  <li><strong>Mode correctness</strong>: conditional/indeterminate outputs must visibly reflect the response mode.</li>
  <li><strong>Trace presence</strong>: when traces exist, the output surfaces that there is auditable evidence.</li>
</ul>

<h2>Why constraints matter</h2>
<p>Without constraints, a fluent realizer can add plausible details that were never derived. Constraints turn the correctness contract into an end-to-end property: not only is the internal reasoning checked, but the emitted text is guaranteed to be a rendering of checked state rather than an additional source of information.</p>

<h2>Audit and user trust</h2>
<p>Faithful realization supports audit. When the user asks why a claim was made, the system can point to the underlying fact identifiers and trace steps. When it cannot justify a claim, it must degrade to conditional or indeterminate outputs rather than inventing.</p>
<figure class="diagram">
<img class="diagram-svg" src="../assets/svg/decoding-diagram.svg" alt="decoding diagram">
<figcaption>Decoding is constrained rendering: it formats checked claims and makes mode/budget limits visible. Continuation (DS011) is a separate optional mechanism and must not be mistaken for a truth source.</figcaption>
</figure>
<h2>References</h2>
<p><a href="https://en.wikipedia.org/wiki/Natural_language_generation">Natural language generation (Wikipedia)</a> <a href="https://en.wikipedia.org/wiki/Explainable_artificial_intelligence">Explainable AI (Wikipedia)</a> <a href="https://en.wikipedia.org/wiki/Verification_and_validation">Verification and validation (Wikipedia)</a></p>
      </main>
      <footer class="footer">
        VSAVM is an Axiologic Research experiment within the Achilles project. This static documentation is written in clear academic English for engineers.
      </footer>
    </div>
  </body>
</html>
